          <div class="top_slogan">
	Files
  </div>
       <div id ="filelist" class="main_content"  style="">
	   
	  
	  					  <table  border="0" cellspacing="0" style="width:100%;padding:20px">
	  					      <tr>
	  					        <th class='lalign'> 
	  					       
	  					        
	  					        <button id="btnadd">Add New File</button>
	  					        
	  					        </td>
	  					
	 					        <th align='right'><span id="downloadcontainer" style="display:none"><a href='#' onclick="downloadcsv('tblfiles');return false;" ><img border='0' src='images/excel.png' title='Download as excel'></a></span></th>
	 					      </tr>
	  					 </table>
 					
			<div id="resultdetailcontainer"/>
			
			<div style="clear:both"></div>
			<br/>
	  <div id="resultstatuscontainer"/>
	  <div style="clear:both"></div>
	  
	

<form id="frmfile">
	<input type="hidden" id="file" name="file"/>
</form>
	  </div>
	  
	  
	

	  <div id ="managefilecontainer" class="main_content"  style="">
	  
	  		//Add file container here
	  </div>
	  
	<form name="deletefile" id="deletefile">
  <input type="hidden" name="host" id="host"  />
  <input type="hidden" name="user" id="user"  />
  <input type="hidden" name="filegroup" id="filegroup"  />
  <input type="hidden" name="team" id="team"  />
  </form>
  
 <script>
 
 function onhandlefiledelete(curdata){
	 

	  $("form#deletefile input").val("")
	  
	  
	  $xml = $(curdata)
	 // console.log($xml)
			 $xml.each(function(index){
				 //Parse here
				 
				var host =  $(this).find('host').text();
 				var port =  $(this).find('port').text();
 				var user =  $(this).find('user').text();
 				var password =  $(this).find('password').text();
 				var proxyhost =  $(this).find('proxyhost').text();
 				var proxyport =  $(this).find('proxyport').text();
 				var proxyuser =  $(this).find('proxyuser').text();
 				var proxypwd =  $(this).find('proxypwd').text();
 				
 				var group = $(this).find('group').text();
 				
 				var team = $(this).find('team').text();
 				
 				//console.log($(this))
 				$("#user").val(user)
 				
 				$("#host").val(host)
 				
 				
 				$( "#filegroup" ).val(group)
 				 $( "#team" ).val(team)

 				
 				
			 })
			 
			 
	 
  	$("#resultstatuscontainer").show()
  	  $("#resultstatuscontainer").html("<img src='images/loadingajax.gif'/>")
  	  
  	  
  	    
 var formdata=$("form#deletefile").serializeArray()
 		
 	
  	
  		
  	$.post( "/services/deletefile", formdata)
 	 	  .done(function( data ) {
 	 	    
 	 		
 	 		//parse xml
 	 		  $xml = $( data )
 	 		  $status = $xml.find( "status" )
 	 		  
 	 		  
 	 		  
 	 		  if( $status.attr("error") =="true"){
 	 			  
 	 			  showerror("resultstatuscontainer",$status.attr("description"))
 	 			  
 	 		  } else{
 	 			 showsuccess("resultstatuscontainer",$status.attr("description"))
 	 			showfilereport();
 	 		  
 	 		  }
 		
 	});
  	
 }
 


	
	
	
function showmanagefilepage(curdata,operation){
	
	
	 //var curdata=decodeURI($(evt.target).parent().attr("data-file"));
		
	 
	 showmanagefilecontainer(true);
		 
		 $("#managefilecontainer").html("<img src='images/loadingajax.gif'/>")
		  $( "#managefilecontainer" ).load( "managefiles.html", function() {
			  
			  initmanagefiles()
			  //console.log(curdata)
			 setmanagefiledata(curdata,operation)
		  		
		});
		 
		 
}	
 
 
 function showmanagefilecontainer(canshow){
	 
	 if(canshow){
		 
		 $("#filelist").hide()
		 $("#managefilecontainer").show()
	 }else{
		 
		 $("#filelist").show()
		 $("#managefilecontainer").hide()
		 $("#managefilecontainer").html("")
		 
	 }
	 
 }
 $( "#btnadd" ).button( {
     icons: {
       primary: "ui-icon-plusthick"
     }
   });
 
 //$( "#btnadd" ).button({ icons: { primary: "ui-icon-gear", secondary: "ui-icon-triangle-1-s" } });

 //ui-icon-plusthick
 
 $( "#btnadd" ).click(function( event ) {
	 
	 
	 showmanagefilepage("","ADD")
 })




 
 function showfilereport( ){
 	
 	$("#resultdetailcontainer").show()
 	  $("#resultdetailcontainer").html("<img src='images/loadingajax.gif'/>")
 	  
 	  
 	      var formdata=null
 	 
 		
 	     filexml=""
 	$.post( "/services/getfiles", formdata)
 	  .done(function( data ) {
 	    
 		 filexml=""
 		
 		//parse xml
 		  $xml = $( data )
 		  $status = $xml.find( "status" )
 		  
 		  
 		  
 		  if( $status.attr("error") =="true"){
 			  
 			  showerror("resultdetailcontainer",$status.attr("description"))
 			  
 		  } else{
 			  
 			 $("#resultdetailcontainer").html("&nbsp;")
 			  var tbl=""
 				
 					
 					var csvtblname="tblfiles"
 					
 					
// 	  					 tbl=tbl + ' <div style="float:left">  <table  border="0" cellspacing="0" style="width:600px">'
// 	  					 tbl=tbl + "      <tr>" 
// 	  					 tbl=tbl + "        <th class='calign'> <a href='#' onclick=\"addfile();return false;\" ><img border='0' src='images/add.png' title='Add'></a></td>"
	  					 
// 	 					 tbl=tbl + "        <th align='right'><span><a href='#' onclick=\"downloadcsv('" +csvtblname  +"');return false;\" ><img border='0' src='images/excel.png' title='Download as excel'></a></span></th>" 
// 	 					 tbl=tbl + "      </tr>" 
// 	  					 tbl=tbl + " </table>"
 					

 				 tbl=tbl + '<table id="tblfiles" style="width:100%" class="display" cellspacing="0" >' 
 				 tbl=tbl + "    <thead>" 
 				 tbl=tbl + "      <tr>" 
 				 tbl=tbl + "        <th><span>S.No</span></th>"
 							
 				 tbl=tbl + "        <th><span>Name</span></th>"
 				tbl=tbl + "        <th><span>Path</span></th>" 	
 				tbl=tbl + "        <th><span>Servers</span></th>"
 				tbl=tbl + "        <th><span>Team</span></th>" 
 				
 				 tbl=tbl + "        <th><span>Status</span></th>"
 				tbl=tbl + "        <th><span>Edit</span></th>"
 				tbl=tbl + "        <th><span>Duplicate</span></th>"
 				 tbl=tbl + "        <th><span>Remove</span></th>" 

 				 tbl=tbl + "      </tr>" 
 				 tbl=tbl + "    </thead>" 
 				 tbl=tbl + "    <tbody>" 
 			
 				var dataCount=0
				
 				
 				 
 			 $xml.find('file').each(function(index){
 				dataCount++
 				
 				 var curdata=encodeURI($(this)[0].outerHTML);
 				console.log(curdata)
 				
 	            var name = $(this).find('name').text();
 				
 				var host =  $(this).find('path').text();
 				var servers =  $(this).find('servers').text();	
 				var team = $(this).find('team').text();
 				
 				    
 				    
 	     	 tbl=tbl + "      <tr>" 
 				 tbl=tbl + "        <td class='calign'>"+dataCount+"</td>" 
 				 
 				tbl=tbl + "        <td class='lalign'>"+ name+"</td>"
 				tbl=tbl + "        <td class='lalign'>"+path+"</td>"
 				tbl=tbl + "        <td class='lalign'>"+servers+"</td>"
 				tbl=tbl + "        <td class='lalign'>"+team+"</td>"
 				
 				 tbl=tbl + "        <td class='calign'> <button type='button' class='btnedit' data-file='"+curdata +"' >&nbsp;</button></td>"
 				tbl=tbl + "        <td class='calign'> <button type='button' class='btnduplicate' data-file='"+curdata +"' >&nbsp;</button></td>"
 				tbl=tbl + "        <td class='calign'> <button type='button' class='btndelete' data-file='"+curdata +"' >&nbsp;</button></td>"
 				
 				    
 				// tbl=tbl + "        <td class='calign'> <a href='#' onclick=\"duplicatefile('" +curdata  +"');return false;\" ><img border='0' src='images/duplicate.png' title='Duplicate'></a></td>"
 				 //tbl=tbl + "        <td class='calign'> <a href='#' onclick=\"deletefile('" +curdata  +"');return false;\" ><img border='0' src='images/delete.png' title='Delete'></a></td>"
 				
 				 tbl=tbl + "      </tr>" 
 				 
 	        });
 			
 				 tbl=tbl + "	      </tbody>" 
 				 tbl=tbl + "  </table></div>"
 				 
 				 if( dataCount >0){
 					 
 				 	$("#resultdetailcontainer").html(tbl)
 				 	$("#downloadcontainer").css("display","")
 				 	
 				 
			    
 				    
 				 	
 				$( "button.btnedit" ).button({
 				      icons: {
 				        primary: "ui-icon-pencil"
 				      },
 				      text: false
 				    })
 				    
 				    $( "button.btnduplicate" ).button({
 				      icons: {
 				        primary: "ui-icon-newwin"
 				      },
 				      text: false
 				    })
 				    
 				    $( "button.btndelete" ).button({
 				      icons: {
 				        primary: "ui-icon-close"
 				      },
 				      text: false
 				    })
 				    
 				    
 				       $("button.btnedit").click(function(evt) {
					    	
 				    	  showmanagefilepage(decodeURI($(evt.target).parent().attr("data-file")),"UPDATE")
 				    	   
					    });
 				 	
 				 	 $("button.btnduplicate").click(function(evt) {
					    	
 				 			showmanagefilepage(decodeURI($(evt.target).parent().attr("data-file")),"ADD")
				    	   
					    });
				 	
 				 	 $("button.btndelete").click(function(evt) {
					    	
				    	   onhandlefiledelete(decodeURI($(evt.target).parent().attr("data-file")))
					    });
				 	
 				 	 
 				 	
 				 	preparecsv("tblfiles")
 				 	
 				  if( dataCount >10){
 					  
 					  
 					$.extend( $.fn.dataTable.defaults, {
 					    "searching": true,
 					    "ordering": true,
 					  "paging":   true,  				        
 				        "info":     true
 					} );
 					$('#tblfiles').dataTable();
 				  }
   					  
 				  else{
 					  
 					$.extend( $.fn.dataTable.defaults, {
 					    "searching": false,
 					    "ordering": false,
 						"paging":   false,  				        
 				        "info":     false
 					} );
 					
 					
 					$('#tblfiles').dataTable();
 				  }	
 				 }
 				// else
 					// showerror("resultdetailcontainer","No Users Available to show")
 				
 					
 					// $('#example').dataTable();
 			  
 		  }
 	  });
 	  
 	
 	
 }
  $(function() {
 
	  showmanagefilecontainer(false)
	  showfilereport()

  });
  </script>